import{_ as j,a as z,r as p,b as i,n as M,o as l,c as r,e as s,g as f,j as o,F as D,k as P,q as N,f as d,t as _,s as X,h as g,l as h,v as G,p as H,m as J}from"./index-CsSw0Q1X.js";import{g as K,c as O}from"./commonUtils-BZyC41Ue.js";import{a as Q,b as W,c as Y,e as Z}from"./businessApi-BLeheLW9.js";import{s as b}from"./request-sBhsa8yO.js";const ee=[{required:!0,message:"请输入身份证号"},{pattern:/^[1-9]\d{5}(?:18|19|20)\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d{3}[\dXx]$/,message:"身份证号格式不正确"}],L=v=>(H("data-v-af854364"),v=v(),J(),v),ae={class:"patient-page"},te={class:"patient-list"},se={class:"info"},oe={class:"name"},ne={class:"id"},le=["onClick"],ie={key:0,class:"tag"},de=L(()=>o("p",null,"添加患者",-1)),ue=L(()=>o("div",{class:"patient-tip"},"最多可添加 6 人",-1)),re={class:"p-3"},pe={__name:"index",setup(v){const B=z(),w=p(!1),k=p([]),n=p(!1),c=p(!1),t=p({id:"",realName:"",idCardNo:"",gender:"1",defaultResume:"0"});function E(u){c.value=!0,t.value.realName=u.realName,t.value.id=u.id,t.value.gender=u.gender,t.value.idCardNo=u.idCardNo,n.value=!0}function I(){c?q():S()}function S(){W(t.value).then(()=>{b({type:"success",message:"添加成功"}),n.value=!1,m()})}function U(){Y(t.value.id).then(()=>{b({type:"success",message:"删除成功"}),n.value=!1,m()})}function q(){Z(t.value).then(()=>{b({type:"success",message:"编辑成功"}),n.value=!1,m()})}async function m(){k.value=await Q()}return m(),(u,e)=>{const C=i("van-nav-bar"),x=i("van-icon"),V=i("van-button"),y=i("van-field"),R=i("van-radio"),F=i("van-radio-group"),A=i("van-form"),T=i("van-popup"),$=M("e");return l(),r(D,null,[s(C,{title:w.value?"选择患者":"家庭档案","left-text":"返回","left-arrow":"",onClickLeft:e[0]||(e[0]=()=>f(B).push({name:"myReg"}))},null,8,["title"]),o("div",ae,[o("div",te,[(l(!0),r(D,null,P(k.value,a=>(l(),r("div",{class:"patient-item",key:a.id},[o("div",se,[o("span",oe,_(a.realName),1),o("span",ne,_(a.idCardNo),1),o("span",null,_(f(K)[a.gender]),1),o("span",null,_(f(O)(a.idCardNo))+" 岁",1)]),o("div",{class:"icon",onClick:X(ve=>E(a),["stop"])},[s(x,{name:"setting-o"})],8,le),a.defaultFlag===1?(l(),r("div",ie,"默认")):N("",!0)]))),128)),k.value.length<6?(l(),r("div",{key:0,class:"patient-add",onClick:e[1]||(e[1]=()=>{n.value=!0,c.value=!1,t.value={}})},[s(x,{name:"plus"}),de])):N("",!0),ue]),w.value?(l(),r("div",{key:0,class:"patient-next",onClick:e[2]||(e[2]=(...a)=>u.next&&u.next(...a))},[s(V,{type:"primary",round:"",block:""},{default:d(()=>[g("下一步")]),_:1})])):N("",!0),s(T,{position:"right",show:n.value,"onUpdate:show":e[8]||(e[8]=a=>n.value=a)},{default:d(()=>[c.value?(l(),h(C,{key:0,title:"编辑","left-text":"返回","right-text":"删除","left-arrow":"",onClickLeft:e[3]||(e[3]=()=>{n.value=!1}),onClickRight:U})):(l(),h(C,{key:1,title:"添加","left-text":"返回","left-arrow":"",onClickLeft:e[4]||(e[4]=()=>{n.value=!1})})),s(A,{autocomplete:"off"},{default:d(()=>[s(y,{modelValue:t.value.realName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.realName=a),name:"name",label:"真实姓名",placeholder:"请输入真实姓名",rules:[{required:!0,message:"请填写真实姓名"}]},null,8,["modelValue"]),s(y,{modelValue:t.value.idCardNo,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.idCardNo=a),label:"身份证号",placeholder:"请输入身份证号",rules:f(ee)},null,8,["modelValue","rules"]),s(y,{name:"radio",label:"性别"},{input:d(()=>[s(F,{modelValue:t.value.gender,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.gender=a),direction:"horizontal"},{default:d(()=>[s(R,{name:"1"},{default:d(()=>[g("男")]),_:1}),s(R,{name:"2"},{default:d(()=>[g("女")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o("div",re,[G((l(),h(V,{onClick:I,round:"",block:"",type:"primary","native-type":"submit"},{default:d(()=>[g(" 提交 ")]),_:1})),[[$]])])]),_:1},8,["show"])])],64)}}},ge=j(pe,[["__scopeId","data-v-af854364"]]);export{ge as default};
