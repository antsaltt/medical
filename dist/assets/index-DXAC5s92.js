import{y as O,z as F,A as V,B as j,e as m,C as G,D as U,_ as T,o as c,c as _,j as e,t as s,g as i,a as W,u as q,r,E as H,b as f,f as x,h as N,F as y,k as D,l as J,G as K,p as M,m as X}from"./index-CsSw0Q1X.js";import{r as Y,a as Z,g as ee}from"./businessApi-BLeheLW9.js";import{g as te,c as ae,r as S}from"./commonUtils-BZyC41Ue.js";import{s as g}from"./request-sBhsa8yO.js";let b;const se={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let ne=O({},se);function oe(){({instance:b}=V({setup(){const{state:l,toggle:d}=j();return()=>m(U,G(l,{"onUpdate:show":d}),null)}}))}function le(t){return F?new Promise((l,d)=>{b||oe(),b.open(O({},ne,t,{callback:v=>{(v==="confirm"?l:d)(v)}}))}):Promise.resolve(void 0)}const re={class:"patient-list"},ce={class:"patient-item"},ie={class:"info"},de={class:"name"},ue={class:"id"},me={__name:"DocItem",props:["realName","idCardNo","gender"],setup(t){return(l,d)=>(c(),_("div",re,[e("div",ce,[e("div",ie,[e("span",de,s(t.realName),1),e("span",ue,s(t.idCardNo),1),e("span",null,s(i(te)[t.gender]),1),e("span",null,s(i(ae)(t.idCardNo))+" 岁",1)])])]))}},_e=T(me,[["__scopeId","data-v-71c4ac8f"]]),$=t=>(M("data-v-0c3824e0"),t=t(),X(),t),ve={class:"p-4 bg-gray-100"},pe={class:"p-2 rounded bg-white flex gap-4"},fe={class:"w-2/5"},ge=["src"],he={class:"flex flex-col"},xe={class:"text-lg"},ye={class:"text-gray-500 text-base"},be={class:"text-base"},we={class:"line-clamp-3 text-sm text-gray-400"},Ce={class:"p-2 rounded bg-white mt-4 flex flex-col"},ke=$(()=>e("div",{class:"font-bold text-lg mt-4"},"选择挂号时间",-1)),Ie={class:"grid grid-cols-4 mt-2 grid-rows-4 gap-4"},Be=["onClick"],Ne=$(()=>e("div",{class:"mt-8"},[e("div",{class:"mb-2"},"注意事项"),e("ol",{class:"flex flex-col gap-3 text-gray-500"},[e("li",null,"1. 挂号平台提供次日起七天的预约服务，用户可预约中医院的大部分科室次日起至七天的就诊号源。"),e("li",null,"2. 因为医生工作繁忙，可能更改或者取消预约时间，届时会第一时间通知您，请留意短信通知。"),e("li",null,"3. 如果您在就诊当天不能前往医院取号就诊，请提前通过挂号平台取消预约，否则会因造成号源的浪费，请您谅解。")])],-1)),De={class:"mt-10"},Se={__name:"index",setup(t){const l=W(),v=q().query.id,p=r(!1),P=r(500),n=r({appointmentTime:[]}),w=r(-1);H(async()=>{try{await C()}catch{g({type:"danger",message:"请求错误"})}});async function C(){n.value=await ee(v)}const o=r({doctorId:"",timeQuantum:void 0,resumeId:""});async function L(){if(await R(),!o.value.resumeId){p.value=!0;return}if(!o.value.timeQuantum){g({type:"danger",message:"请选择预约时间段"});return}if(!o.value.timeQuantum){g({type:"danger",message:"请选择预约时间段"});return}o.value.doctorId=n.value.id,Y(o.value).then(()=>{le({title:"提示",message:"预约成功",theme:"round-button"}),C()})}const k=h=>n.value.appointmentTime.indexOf(h)!==-1,I=r([]);async function R(){I.value=await Z()}return(h,u)=>{const A=f("van-floating-panel"),E=f("van-overlay"),Q=f("van-nav-bar"),z=f("van-button");return c(),_(y,null,[m(E,{show:p.value,onClick:u[0]||(u[0]=a=>p.value=!1)},{default:x(()=>[m(A,{"v-model:height":P.value,duration:"0.6"},{default:x(()=>[(c(!0),_(y,null,D(I.value,a=>(c(),J(_e,{onClick:()=>{p.value=!1,o.value.resumeId=a.id,i(g)({type:"success",message:"选择成功"})},gender:a.gender,"id-card-no":a.idCardNo,"real-name":a.realName},null,8,["onClick","gender","id-card-no","real-name"]))),256))]),_:1},8,["v-model:height"])]),_:1},8,["show"]),m(Q,{title:"挂号预约","left-text":"返回","left-arrow":"",onClickLeft:u[1]||(u[1]=()=>i(l).back())}),e("div",ve,[e("div",pe,[e("div",fe,[e("img",{class:"w-full rounded-full",src:n.value.avatar,alt:""},null,8,ge)]),e("div",he,[e("div",null,[e("span",xe,s(n.value.name),1),N(),e("span",ye,"("+s(n.value.title)+")",1)]),e("div",be,s(n.value.hosName),1),e("div",we,s(n.value.desc),1)])]),e("div",Ce,[ke,e("div",Ie,[(c(!0),_(y,null,D(Object.keys(i(S)),(a,B)=>(c(),_("div",{class:K([[{"bg-zinc-200":w.value===B},{"cursor-not-allowed":k(a)}],"rounded-xl text-center p-1.5 bg-gray-50 text-base"]),onClick:()=>{k(a)||(w.value=B),o.value.timeQuantum=a}},s(i(S)[a]),11,Be))),256))]),Ne]),e("div",De,[m(z,{onClick:L,type:"primary",block:""},{default:x(()=>[N("挂号")]),_:1})])])],64)}}},Le=T(Se,[["__scopeId","data-v-0c3824e0"]]);export{Le as default};
